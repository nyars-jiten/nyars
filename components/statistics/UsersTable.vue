<script setup lang="ts">
  // const { getWeeklyTopUsers } = useApi(jpnEntryRepository)

  function getWeeklyTopUsers() {
    return [
      {
        id: 7,
        username: 'Ева',
        banned: false,
        role: 'User',
        access: 1032192,
        avatar: '6bf3488d-da95-4936-880a-c66fb4bf3070.jpg',
        isBot: false,
        userRating: {
          id: 8,
          userRef: 7,
          alltimeRating: 6534,
          monthRating: 3149,
          weekRating: 1418,
          todayRating: 0,
          summary: {
            alltime: {
              japNew: 595,
              japEdit: 2009,
              japNewAuto: 101,
              japEditAuto: 322,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 308
            },
            month: {
              japNew: 81,
              japEdit: 1145,
              japNewAuto: 101,
              japEditAuto: 207,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 308
            },
            week: {
              japNew: 44,
              japEdit: 470,
              japNewAuto: 89,
              japEditAuto: 138,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 119
            },
            today: {
              japNew: 0,
              japEdit: 0,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            }
          }
        },
        createdDate: new Date('2020-12-02T10:58:40.860082Z')
      },
      {
        id: 1,
        username: 'Ёко',
        banned: false,
        role: 'Admin',
        access: 0,
        avatar: 'f0eccae4-0bd2-4d77-9bc5-095cd90ba058.png',
        isBot: false,
        userRating: {
          id: 2,
          userRef: 1,
          alltimeRating: 38279,
          monthRating: 771,
          weekRating: 671,
          todayRating: 0,
          summary: {
            alltime: {
              japNew: 650,
              japEdit: 7237,
              japNewAuto: 7207,
              japEditAuto: 4202,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 2,
              approved: 10440
            },
            month: {
              japNew: 5,
              japEdit: 137,
              japNewAuto: 280,
              japEditAuto: 152,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 50
            },
            week: {
              japNew: 3,
              japEdit: 96,
              japNewAuto: 273,
              japEditAuto: 147,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 50
            },
            today: {
              japNew: 0,
              japEdit: 0,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            }
          }
        },
        createdDate: new Date('2020-10-12T21:35:20.538224Z')
      },
      {
        id: 111,
        username: '❤Hanzomane❤',
        banned: false,
        role: 'User',
        access: 0,
        avatar: '672ac0d0-1f63-4f7f-93d3-3e290d1a0798.jpg',
        isBot: false,
        userRating: {
          id: 112,
          userRef: 111,
          alltimeRating: 4264,
          monthRating: 236,
          weekRating: 144,
          todayRating: 0,
          summary: {
            alltime: {
              japNew: 34,
              japEdit: 2081,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            month: {
              japNew: 2,
              japEdit: 115,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            week: {
              japNew: 2,
              japEdit: 69,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            today: {
              japNew: 0,
              japEdit: 0,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            }
          }
        },
        createdDate: new Date('2023-01-20T03:29:47.472207Z')
      },
      {
        id: 132,
        username: 'キュゥべえ',
        banned: false,
        role: 'User',
        access: 0,
        avatar: 'bb499b49-4b7d-4325-9300-c5ba7f00f7bd.jpg',
        isBot: false,
        userRating: {
          id: 133,
          userRef: 132,
          alltimeRating: 434,
          monthRating: 130,
          weekRating: 130,
          todayRating: 0,
          summary: {
            alltime: {
              japNew: 2,
              japEdit: 214,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            month: {
              japNew: 0,
              japEdit: 65,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            week: {
              japNew: 0,
              japEdit: 65,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            today: {
              japNew: 0,
              japEdit: 0,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            }
          }
        },
        createdDate: new Date('2024-04-26T10:42:05.941592Z')
      },
      {
        id: 121,
        username: 'kawaiitaikodrum',
        banned: false,
        role: 'User',
        access: 0,
        avatar: '862853af-8e27-4bed-a3e8-d1538633a898.jpg',
        isBot: false,
        userRating: {
          id: 122,
          userRef: 121,
          alltimeRating: 271,
          monthRating: 36,
          weekRating: 36,
          todayRating: 0,
          summary: {
            alltime: {
              japNew: 3,
              japEdit: 131,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            month: {
              japNew: 0,
              japEdit: 18,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            week: {
              japNew: 0,
              japEdit: 18,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            today: {
              japNew: 0,
              japEdit: 0,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            }
          }
        },
        createdDate: new Date('2023-10-31T13:25:03.498381Z')
      },
      {
        id: 4,
        username: 'петя',
        banned: false,
        role: 'Admin',
        access: 0,
        avatar: '2a3bd837-5489-448b-adb7-92142d8dc7f8.jpg',
        isBot: false,
        userRating: {
          id: 5,
          userRef: 4,
          alltimeRating: 18426,
          monthRating: 44,
          weekRating: 9,
          todayRating: 0,
          summary: {
            alltime: {
              japNew: 620,
              japEdit: 6239,
              japNewAuto: 3189,
              japEditAuto: 433,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 1,
              kanjiEdit: 10,
              approved: 433
            },
            month: {
              japNew: 2,
              japEdit: 12,
              japNewAuto: 14,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            week: {
              japNew: 1,
              japEdit: 3,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            },
            today: {
              japNew: 0,
              japEdit: 0,
              japNewAuto: 0,
              japEditAuto: 0,
              rusNew: 0,
              rusEdit: 0,
              kanjiNew: 0,
              kanjiEdit: 0,
              approved: 0
            }
          }
        },
        createdDate: new Date('2020-10-13T20:09:57.343959Z')
      }
    ]
  }

  const { data: users } = await useLazyAsyncData(
    'users',
    () => Promise.resolve(getWeeklyTopUsers()),
    {
      default: () => [],
      transform: (users) => {
        return users.map((user) => ({
          id: user.id,
          avatar: user.avatar,
          username: user.username,
          weekRating: user.userRating?.weekRating,
          jpnNew: user.userRating?.summary.week.japNew,
          jpnEdit: user.userRating?.summary.week.japEdit,
          jpnNewAuto: user.userRating?.summary.week.japNewAuto,
          jpnEditAuto: user.userRating?.summary.week.japEditAuto,
          approved: user.userRating?.summary.week.approved
        }))
      }
    }
  )
</script>

<template>
  <section class="space-y-4">
    <h1 class="text-2xl text-center">
      Рейтинг за 7 дней
    </h1>

    <section class="space-y-4">
      <WeeklyActiveUser v-bind="{ position: index+1, ...user }" v-for="(user, index) of users" :key="user.id" />
    </section>
    
  </section>
</template>
